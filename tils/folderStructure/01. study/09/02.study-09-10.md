벨로그 폴더스트럭쳐 + 디펜던시 따라해보기

이력서에 내 시스템(내 개발 공부 루틴을 반드시 작성하고 이에 대한 성과를 적자
실무에 어떻게 적용했나? 어떻게 하루에 1커밋해서 무엇을 만들었나?)

2022/09/10 작성 중

헤더를 넣어보는 것으로 시작해보자.

import { Route, Switch, Redirect } from 'react-router-dom';

app.tsx 그대로 넣어보자
import loadable from '@loadable/component'; // SSR 뺌
import Core from './containers/base/Core'; // 한번 보고 추가
import RegisterPage from './pages/RegisterPage'; // 나중에
import { JazzbarProvider } from './lib/jazzbar'; // 뺌 뭐하는지모르겟음
import PageTemplate from './components/base/PageTemplate'; // 여기 헤더와 floatingHeader가 있다. 근데 사용하지 않는거 갓아서 일단 뺌
import VelogPageFallback from './containers/velog/VelogPageFallback'; // 로드실패, loadable이기 때문에 뺀다.
import ErrorBoundary from './components/error/ErrorBoundary'; // 이건 넣는다. 어떤일하는지 기억해두자.
import NotFoundPage from './pages/NotFoundPage'; // 일단 뺌
import { Helmet } from 'react-helmet-async'; // 이건 넣는다. 뭐인지도 아니까
import HomePage from './pages/home/HomePage'; // 여기서 헤더까지 넣어봄
import MainPageTemplate from './components/main/MainPageTemplate'; // 일단 뺌
import ConditionalBackground from './components/base/ConditionalBackground'; // 이건 넣는다.

import Core from './containers/base/Core'; // 한번 보고 추가
import ErrorBoundary from './components/error/ErrorBoundary'; // 이건 넣는다. 어떤일하는지 기억해두자.
import { Helmet } from 'react-helmet-async'; // 이건 넣는다. 뭐인지도 아니까
import HomePage from './pages/home/HomePage'; // 여기서 헤더까지 넣어봄
import ConditionalBackground from './components/base/ConditionalBackground'; // 이건 넣는다.


일단 헬멧, errorboundary부터 넣는다. 가장 쉬우니깐.

1. 헬멧

index.js 에 HelmetProvider
app.tsx에 Helmet으로 감싸서 넣어준다.
나중에 페이지별로 나눠서 넣어주면 됨.

2. ErrorBoundary

src/components/error에 추가함. 
class형 컴포넌트이기 때문에, React.components 뒤에 <any, any> 를 추가해주었다.

차후 class형을 얼마나 더 볼지 모르겠으니까, 여기를 더 손댈 필요는 없을 것 같다.

각종 에러케이스 화면과, Sentry 적용은 일단 뒤로 미룬다.

3. Homepage.tsx

src/page/home에 만들어줌.
page/home/hook 부분은 아직 없으니까 폴더만 만듬.

import React from 'react';
import MainTemplate from '../../components/main/MainTemplate';
import Header from '../../components/base/Header';
import HomeTab from '../../components/home/HomeTab';
import MainResponsive from '../../components/main/MainResponsive';
import HomeLayout from '../../components/home/HomeLayout';
import { Route } from 'react-router-dom';
import TrendingPostsPage from './TrendingPostsPage';
import RecentPostsPage from './RecentPostsPage';
import FloatingHeader from '../../components/base/FloatingHeader';

일단 헤더만 만들어 본다.

일단, 

4. import { Route, Switch, Redirect } from 'react-router-dom';

여기서 스위치, 리다리엙트가 임포드가 안되던데, 아마 버전업 때문인듯함

여기서 exact는 v6에서 사라짐. switch는 v5에서 사라짐.

5. Header.tsx

// import React, { useRef, useCallback } from 'react';
// import styled from 'styled-components';
// import { SearchIcon2 } from '../../static/svg';
import RoundButton from '../common/RoundButton';
import MainResponsive from '../main/MainResponsive';
import useHeader from './hooks/useHeader'; // 일단 graph나 redux는 넘어가자
import HeaderUserIcon from './HeaderUserIcon';
// import useToggle from '../../lib/hooks/useToggle';
import HeaderUserMenu from './HeaderUserMenu';
// import { Link } from 'react-router-dom';
// import media from '../../lib/styles/media';
import HeaderLogo from './HeaderLogo';
import { themedPalette } from '../../lib/styles/themes';
import ThemeToggleButton from './ThemeToggleButton';
// import { useSelector } from 'react-redux';
// import { RootState } from '../../modules';

스타일의 가장 중요한 부분이 되기 때문에 중요하게 적고 넘어가야 할듯함.

import media from '../../lib/styles/media';
이 부분 코드는 아주 유용할 것 같다.(styled-components로 이것만 쓴다고 하더라도, 물론 디자인 라이브러리를 쓸 경우에는 이에 맞게 픽셀을 바꿔주는 것이 좋을 것 같음.)

https://getbootstrap.com/docs/5.0/layout/breakpoints/
부트스트랩에서는 sass를 쓸경우 바꿀 수 있다고 docs에 나와있다.


import { themedPalette } from '../../lib/styles/themes';

이 부분은 사실 디자이너와 말해야 할 부분이다.

https://velog.io/@velopert/velog-dark-mode 의 예시를 보고 구현했고,

.src/lib/styles/GlobalStyles.ts
.src/lib/styles/themes.ts

의 내용으로 App.tsx에 globalstyles 태그를 넣어 body에 추가할 수 있었음.



중요한 것은 적용된 색깔을 css variable로 저장하는 것.



import HeaderLogo from './HeaderLogo';


svg폴더에 svg를 export 할 ReactComponent로 위해서 src/static/svgs/index.ts를 추가해 줌

https://velog.io/@ahn0min/SVG-%ED%8C%8C%EC%9D%BC%EC%9D%84-React-TypeScript-%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0

여기서 확인하기

봐야할 파일 
src/types/custom.d.ts
src/static/svgs

import useToggle from '../../lib/hooks/useToggle';

은 가장 기본적인 hook. state만 bool 바꿔 주니까.

src/lib/hooks/useToggle.tsx 내용 확인할 것.


이를 위해서 postcss를 설치했는데, webpack에서

[webpack-cli] Invalid configuration object. Webpack has been initialized using a configuration object that does not match the API schema.
 - configuration.module.rules[1] should be one of these:
   ["..." | object { assert?, compiler?, dependency?, descriptionData?, enforce?, exclude?, generator?, include?, issuer?, issuerLayer?, layer?, loader?, mimetype?, oneOf?, options?, parser?, realResource?, resolve?, resource?, resourceFragment?, resourceQuery?, rules?, scheme?, sideEffects?, test?, type?, use? }, ...]
   -> A rule.
   Details:
    * configuration.module.rules[1].include[0]: The provided value "src" is not an absolute path!
    * configuration.module.rules[1].include[1]: The provided value "src/custom.d.ts" is not an absolute path!
    * configuration.module.rules[1].include[0]: The provided value "src" is not an absolute path!
    * configuration.module.rules[1].include[1]: The provided value "src/custom.d.ts" is not an absolute path!

    에러가 난다.

    이 문제는 아래 svg를 reactComponent로 export했기 때문에 일어난 일로,
    svg 자체를 url 로 보내주는 방법으로 해결 가능했음.

        "url-loader": "^4.1.1",
       설치해 주고
               use: ["@svgr/webpack", "url-loader"],
     webpack.config.js 에서 이거 추가해준다.

     

